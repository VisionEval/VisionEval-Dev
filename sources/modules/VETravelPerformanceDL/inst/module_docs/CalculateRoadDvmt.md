
# CalculateRoadDvmt Module
### January 27, 2019

When run for the base year, this module computes several factors used in computing roadway DVMT including factors for calculating commercial service vehicle travel and heavy truck travel. While base year heavy truck DVMT and commercial service vehicle DVMT are calculated directly from inputs and model parameters, future year DVMT is calculated as a function of the declared growth basis which for heavy trucks may be population or income, and for commercial service vehicles may be population, income, or household DVMT. Factors are calculated for each basis. In non-base years, the module uses these factors to compute heavy truck and commercial service DVMT. This module also calculates the proportions of light duty vehicles, heavy truck, and bus DVMT that are driverless.

In the base year, the module computes factors for allocating light-duty vehicle (LDV) travel demand of marea households and related commercial service vehicle demand to urban roadways in the mareas and to non-urban roadways. These factors are used to compute urban area roadway DVMT which is used in the calculation of urban area congestion. The factors are applied to calculate urban roadway LDV DVMT in non-base years. In addition, the module allocates urban LDV roadway DVMT proportions to households, identifying the proportion of each household's DVMT that takes place on urban area roadways. This proportion is used in the adjustment of the fuel economy of household vehicles as a function of urban area congestion.

The proportions of DVMT that are driverless, as computed by module, for LDV, heavy truck, and bus is used to determine road performance.

Finally, the module adds together the urban LDV DVMT, urban heavy truck DVMT, and public transit DVMT and allocates it to road classes (freeway, arterial, other) for use in congestion calculations by the CalculateTravelPerformance module.

## Model Parameter Estimation

This module has no estimated parameters.

## How the Module Works

This module calculates several values necessary for calculating urbanized area road performance metrics by the CalculateRoadPerformance module as follows:

* *Calculate heavy truck growth factors*: Base year heavy truck DVMT is calculated for the region and heavy truck DVMT on urbanized area roadways is calculated for each marea in the Initialize module. The ratios of these heavy truck DVMT estimates with base year regional and marea population and with base year regional and marea income are calculated and saved to the datastore. These ratios are used to calculate future year heavy truck DVMT using either future year population or future year income. Whether population or income is used as the basis for calculating heavy truck DVMT is determined by the value of HvyTrkDvmtGrowthBasis in the 'region_base_year_dvmt.csv' input file.

* *Calculate commercial service vehicle growth factors*: Base year commercial service vehicle (light-duty) DVMT is calculated for each marea in the Initialize module. The ratios of commercial service DVMT with base year marea household DVMT, population, and income are calculated and saved to the datastore. These ratios are used to calculate future year commercial service DVMT using future year household DVMT, population, or income. Which is used as a basis for calculating commercial service DVMT is determined by the value of ComSvcDvmtGrowthBasis in the 'region_base_year_dvmt.csv' input file.

* *Calculate ratio of urban light-duty vehicle roadway DVMT to urban light-duty vehicle (LDV) travel demand*: The CalculateHouseholdDvmt module in the VEHouseholdTravel package calculates the DVMT of households irrespective of where that travel occurs. Likewise commercial service vehicle travel that is calculated is the travel associated with households and the employment of household workers. For each marea to calculate the ratio of light-duty urban roadway DVMT to light-duty vehicle travel demand of urban area households (household DVMT, commercial service DVMT, and public transit DVMT) is calculated. This calculation uses the base year urban roadway DVMT calculated by the Initialize module, the modeled base year household DVMT, the base year commercial service DVMT calculated from the modeled base year household DVMT and the 2010 estimate of the ratio of commercial service DVMT to household DVMT calculated by the 'LoadDefaultRoadDvmtValues.R' script, and the base year public transit van DVMT calculated by the AssignTransitService module in the VETransportSupply package.

* *Calculate marea urban base year road DVMT by vehicle type (LDV, heavy truck, bus) and road class (freeway, arterial, other)*: Base year urban roadway LDV DVMT and heavy truck DVMT are calculated as described above. Bus DVMT is calculated by the AssignTransitService module. These respective DVMT quantities are split between road classes using the proportional factors calculated by the Initialize module which either uses user inputs in the 'marea_dvmt_split_by_road_class.csv' file or default values calculated from Highway Statistics data by the LoadDefaultRoadDvmtValues.R script where data is not supplied by the user. For light-duty urban road DVMT, the freeway and arterial proportion of DVMT is combined. The CalculateRoadPerformance module splits this into freeway and arterial components based on operating conditions and prices.

* *Calculate driverless DVMT proportions*: The driverless DVMT proportion for heavy truck and bus is calculated by linearly interpolating the proportion values provided in 'region_driverless_vehicle_prop.csv' as input for model year. Similarly, the driverless DVMT proportion for household vehicles, commercial service vehicles, and public transit is calculated by linearly interpolating the input values for model year. The proprtion of DVMT that is driverless for light duty vehicles is then calculated as the weighted sum of driverless DVMT proportions for household vehicles, CSV, and public transit.



## User Inputs
This module has no user input requirements.

## Datasets Used by the Module
The following table documents each dataset that is retrieved from the datastore and used by the module. Each row in the table describes a dataset. All the datasets must be present in the datastore. One or more of these datasets may be entered into the datastore from the user input files. The table names and their meanings are as follows:

NAME - The dataset name.

TABLE - The table in the datastore that the data is retrieved from.

GROUP - The group in the datastore where the table is located. Note that the datastore has a group named 'Global' and groups for every model run year. For example, if the model run years are 2010 and 2050, then the datastore will have a group named '2010' and a group named '2050'. If the value for 'GROUP' is 'Year', then the dataset will exist in each model run year group. If the value for 'GROUP' is 'BaseYear' then the dataset will only exist in the base year group (e.g. '2010'). If the value for 'GROUP' is 'Global' then the dataset will only exist in the 'Global' group.

TYPE - The data type. The framework uses the type to check units and inputs. Refer to the model system design and users guide for information on allowed types.

UNITS - The units that input values need to represent. Some data types have defined units that are represented as abbreviations or combinations of abbreviations. For example 'MI/HR' means miles per hour. Many of these abbreviations are self evident, but the VisionEval model system design and users guide should be consulted.

PROHIBIT - Values that are prohibited. Values in the datastore do not meet any of the listed conditions.

ISELEMENTOF - Categorical values that are permitted. Values in the datastore are one or more of the listed values.

|NAME                       |TABLE                 |GROUP  |TYPE      |UNITS      |PROHIBIT     |ISELEMENTOF                |
|:--------------------------|:---------------------|:------|:---------|:----------|:------------|:--------------------------|
|HvyTrkDvmtGrowthBasis      |Region                |Global |character |ID         |             |Income, Population         |
|StateAbbrLookup            |Region                |Global |character |ID         |             |                           |
|HvyTrkDvmt                 |Region                |Global |compound  |MI/DAY     |< 0          |                           |
|ComSvcDvmtGrowthBasis      |Region                |Global |character |ID         |             |HhDvmt, Income, Population |
|Marea                      |Marea                 |Global |character |ID         |             |                           |
|UzaNameLookup              |Marea                 |Global |character |ID         |             |                           |
|UrbanLdvDvmt               |Marea                 |Global |compound  |MI/DAY     |< 0          |                           |
|UrbanHvyTrkDvmt            |Marea                 |Global |compound  |MI/DAY     |< 0          |                           |
|LdvFwyDvmtProp             |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|LdvArtDvmtProp             |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|LdvOthDvmtProp             |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|HvyTrkFwyDvmtProp          |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|HvyTrkArtDvmtProp          |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|HvyTrkOthDvmtProp          |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|BusFwyDvmtProp             |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|BusArtDvmtProp             |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|BusOthDvmtProp             |Marea                 |Global |double    |proportion |< 0, > 1     |                           |
|VehYear                    |RegionDriverlessProps |Global |time      |YR         |NA           |                           |
|ComSvcDriverlessProp       |RegionDriverlessProps |Global |double    |proportion |< 0, > 1     |                           |
|HvyTrkDriverlessProp       |RegionDriverlessProps |Global |double    |proportion |< 0, > 1     |                           |
|PtVanDriverlessProp        |RegionDriverlessProps |Global |double    |proportion |< 0, > 1     |                           |
|BusDriverlessProp          |RegionDriverlessProps |Global |double    |proportion |< 0, > 1     |                           |
|Marea                      |Marea                 |Year   |character |ID         |             |                           |
|VanDvmt                    |Marea                 |Year   |compound  |MI/DAY     |NA, < 0      |                           |
|BusDvmt                    |Marea                 |Year   |compound  |MI/DAY     |NA, < 0      |                           |
|RuralPop                   |Marea                 |Year   |people    |PRSN       |NA, < 0      |                           |
|TownPop                    |Marea                 |Year   |people    |PRSN       |NA, < 0      |                           |
|UrbanPop                   |Marea                 |Year   |people    |PRSN       |NA, < 0      |                           |
|RuralIncome                |Marea                 |Year   |currency  |USD        |NA, < 0      |                           |
|TownIncome                 |Marea                 |Year   |currency  |USD        |NA, < 0      |                           |
|UrbanIncome                |Marea                 |Year   |currency  |USD        |NA, < 0      |                           |
|UrbanHhDvmt                |Marea                 |Year   |compound  |MI/DAY     |NA, < 0      |                           |
|TownHhDvmt                 |Marea                 |Year   |compound  |MI/DAY     |NA, < 0      |                           |
|RuralHhDvmt                |Marea                 |Year   |compound  |MI/DAY     |NA, < 0      |                           |
|Marea                      |Household             |Year   |character |ID         |             |                           |
|LocType                    |Household             |Year   |character |category   |NA           |Urban, Town, Rural         |
|Dvmt                       |Household             |Year   |compound  |MI/DAY     |NA, < 0      |                           |
|DriverlessDvmtProp         |Household             |Year   |double    |proportion |NA, < 0, > 1 |                           |
|HvyTrkDvmtIncomeFactor     |Region                |Global |compound  |MI/USD     |NA, < 0      |                           |
|HvyTrkDvmtPopulationFactor |Region                |Global |compound  |MI/PRSN    |NA, < 0      |                           |
|ComSvcDvmtHhDvmtFactor     |Marea                 |Global |double    |proportion |NA, < 0      |                           |
|ComSvcDvmtIncomeFactor     |Marea                 |Global |compound  |MI/USD     |NA, < 0      |                           |
|HvyTrkDvmtIncomeFactor     |Marea                 |Global |compound  |MI/USD     |NA, < 0      |                           |
|ComSvcDvmtPopulationFactor |Marea                 |Global |compound  |MI/PRSN    |NA, < 0      |                           |
|HvyTrkDvmtPopulationFactor |Marea                 |Global |compound  |MI/PRSN    |NA, < 0      |                           |
|LdvUrbanRoadProp           |Marea                 |Global |double    |proportion |NA, < 0, > 1 |                           |

## Datasets Produced by the Module
The following table documents each dataset that is retrieved from the datastore and used by the module. Each row in the table describes a dataset. All the datasets must be present in the datastore. One or more of these datasets may be entered into the datastore from the user input files. The table names and their meanings are as follows:

NAME - The dataset name.

TABLE - The table in the datastore that the data is retrieved from.

GROUP - The group in the datastore where the table is located. Note that the datastore has a group named 'Global' and groups for every model run year. For example, if the model run years are 2010 and 2050, then the datastore will have a group named '2010' and a group named '2050'. If the value for 'GROUP' is 'Year', then the dataset will exist in each model run year. If the value for 'GROUP' is 'BaseYear' then the dataset will only exist in the base year group (e.g. '2010'). If the value for 'GROUP' is 'Global' then the dataset will only exist in the 'Global' group.

TYPE - The data type. The framework uses the type to check units and inputs. Refer to the model system design and users guide for information on allowed types.

UNITS - The units that input values need to represent. Some data types have defined units that are represented as abbreviations or combinations of abbreviations. For example 'MI/HR' means miles per hour. Many of these abbreviations are self evident, but the VisionEval model system design and users guide should be consulted.

PROHIBIT - Values that are prohibited. Values in the datastore do not meet any of the listed conditions.

ISELEMENTOF - Categorical values that are permitted. Values in the datastore are one or more of the listed values.

DESCRIPTION - A description of the data.

|NAME                       |TABLE     |GROUP  |TYPE     |UNITS      |PROHIBIT     |ISELEMENTOF |DESCRIPTION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|:--------------------------|:---------|:------|:--------|:----------|:------------|:-----------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|LdvDriverlessProp          |Marea     |Year   |double   |proportion |< 0, > 1     |            |Proportion of DVMT of light duty vehicles that is driverless for households in each Marea.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|HvyTrkDriverlessProp       |Marea     |Year   |double   |proportion |< 0, > 1     |            |Proportion of DVMT of heavy trucks that is driverless in each Marea.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|BusDriverlessProp          |Marea     |Year   |double   |proportion |< 0, > 1     |            |Proportion of DVMT of Bus that is driverless in each Marea.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|HhDriverlessDvmtProp       |Marea     |Year   |double   |proportion |< 0, > 1     |            |Proportion of household DVMT that is driverless in each Marea.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|HvyTrkDvmt                 |Region    |Global |compound |MI/DAY     |< 0          |            |Average daily vehicle miles of travel on roadways in the region by heavy trucks during the base year. The value for this input may be NA instead of number. In that case, if a state abbreviation is provided, the base year value is calculated from the state per capita rate tabulated by the LoadDefaultRoadDvmtValues.R script and the base year population. If the state abbreviation is NA (as for a metropolitan model) the base year value is calculated from metropolitan area per capita rates and metropolitan area population. |
|UrbanLdvDvmt               |Marea     |Global |compound |MI/DAY     |< 0          |            |Average daily vehicle miles of travel on roadways in the urbanized portion of the Marea by light-duty vehicles during the base year. This value may be omitted if a value for UzaNameLookup is provided so that a value may be computed from the urbanized area per capita rate tabulated by the LoadDefaultRoadDvmtValues.R script and the base year urban population.                                                                                                                                                                     |
|UrbanHvyTrkDvmt            |Marea     |Global |compound |MI/DAY     |< 0          |            |Average daily vehicle miles of travel on roadways in the urbanized portion of the Marea by heavy trucks during he base year. This value may be omitted if a value for UzaNameLookup is provided so that a value may be computed from the urbanized area per capita rate tabulated by the LoadDefaultRoadDvmtValues.R script and the base year urban population.                                                                                                                                                                             |
|HvyTrkDvmtIncomeFactor     |Region    |Global |compound |MI/USD     |NA, < 0      |            |Ratio of Region base year heavy truck DVMT to household income                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|HvyTrkDvmtPopulationFactor |Region    |Global |compound |MI/PRSN    |NA, < 0      |            |Ratio of Region base year heavy truck DVMT to population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|HvyTrkUrbanDvmt            |Region    |Year   |compound |MI/DAY     |NA, < 0      |            |Region heavy truck daily vehicle miles of travel in urbanized areas                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|HvyTrkNonUrbanDvmt         |Region    |Year   |compound |MI/DAY     |NA, < 0      |            |Region heavy truck daily vehicle miles of travel outside of urbanized areas (i.e. in town or rural areas)                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|ComSvcDvmtHhDvmtFactor     |Marea     |Global |double   |proportion |NA, < 0      |            |Ratio of Marea base year commercial service DVMT to household DVMT                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|ComSvcDvmtIncomeFactor     |Marea     |Global |compound |MI/USD     |NA, < 0      |            |Ratio of base year commercial service vehicle DVMT to household income                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|HvyTrkDvmtIncomeFactor     |Marea     |Global |compound |MI/USD     |NA, < 0      |            |Ratio of base year heavy truck DVMT to household income                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|ComSvcDvmtPopulationFactor |Marea     |Global |compound |MI/PRSN    |NA, < 0      |            |Ratio of base year commercial service vehicle DVMT to population                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|HvyTrkDvmtPopulationFactor |Marea     |Global |compound |MI/PRSN    |NA, < 0      |            |Ratio of base year heavy truck DVMT to population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|LdvUrbanRoadProp           |Marea     |Global |double   |proportion |NA, < 0, > 1 |            |The proportion of the DVMT of households residing in the marea and associated commercial service DVMT that occurs on urbanized area roadways in the marea                                                                                                                                                                                                                                                                                                                                                                                   |
|ComSvcUrbanDvmt            |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Commercial service daily vehicle miles of travel associated with Marea urbanized household activity                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|ComSvcTownDvmt             |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Commercial service daily vehicle miles of travel associated with Marea town household activity                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|ComSvcRuralDvmt            |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Commercial service daily vehicle miles of travel associated with Marea rural household activity                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|HvyTrkUrbanDvmt            |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Heavy truck daily vehicle miles of travel on urbanized area roadways in the Marea                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|LdvFwyArtDvmt              |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Light-duty daily vehicle miles of travel in the urbanized portion of the Marea occurring on freeway or arterial roadways                                                                                                                                                                                                                                                                                                                                                                                                                    |
|LdvOthDvmt                 |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Light-duty daily vehicle miles of travel in the urbanized portion of the Marea occurring on other roadways                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|HvyTrkFwyDvmt              |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Heavy truck daily vehicle miles of travel in the urbanized portion of the Marea occurring on freeways                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|HvyTrkArtDvmt              |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Heavy truck daily vehicle miles of travel in the urbanized portion of the Marea occurring on arterial roadways                                                                                                                                                                                                                                                                                                                                                                                                                              |
|HvyTrkOthDvmt              |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Heavy truck daily vehicle miles of travel in the urbanized portion of the Marea occurring on other roadways                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|BusFwyDvmt                 |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Bus daily vehicle miles of travel in the urbanized portion of the Marea occurring on freeways                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|BusArtDvmt                 |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Bus daily vehicle miles of travel in the urbanized portion of the Marea occurring on arterial roadways                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|BusOthDvmt                 |Marea     |Year   |compound |MI/DAY     |NA, < 0      |            |Bus daily vehicle miles of travel in the urbanized portion of the Marea occuring on other roadways                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|UrbanHhPropUrbanDvmt       |Marea     |Year   |double   |proportion |NA, < 0, > 1 |            |Average proportion of urban household DVMT traveled on urban roads in the marea where the household resides                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|NonUrbanHhPropUrbanDvmt    |Marea     |Year   |double   |proportion |NA, < 0, > 1 |            |Average proportion of non-urban household DVMT traveled on urban roads in the marea where the household resides                                                                                                                                                                                                                                                                                                                                                                                                                             |
|UrbanDvmtProp              |Household |Year   |double   |proportion |NA, < 0, > 1 |            |Proportion of household DVMT traveled on urban roads in the marea where the household resides                                                                                                                                                                                                                                                                                                                                                                                                                                               |
